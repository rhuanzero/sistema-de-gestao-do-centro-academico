<div class="patrimonio-container">
  
  <header class="page-header">
    <div class="header-content">
      <h2>üì¶ Gest√£o de Patrim√¥nio</h2>
      <span class="badge-total">Total: {{ itens.length }} itens</span>
    </div>
  </header>

  <div *ngIf="erro" class="alert alert-error">
    <span>{{ erro }}</span>
    <button (click)="erro = ''" class="btn-close">‚úñ</button>
  </div>

  <div class="content-grid">
    
    <section class="form-section">
      <div class="card sticky-card">
        <h3>{{ modoEdicao ? '‚úèÔ∏è Editar Item' : '‚ûï Novo Item' }}</h3>

        <form [formGroup]="form" (ngSubmit)="onSubmit()">
          
          <div class="form-group">
            <label>Nome do Item</label>
            <input formControlName="nome" type="text" placeholder="Ex: Projetor Epson X5">
          </div>

          <div class="form-row">
            <div class="form-group half">
              <label>Tombo/ID</label>
              <input formControlName="tombo" type="text" placeholder="12345">
            </div>
            <div class="form-group half">
              <label>Valor (R$)</label>
              <input formControlName="valor" type="number" placeholder="0,00">
            </div>
          </div>

          <div class="form-group">
            <label>Estado de Conserva√ß√£o</label>
            <select formControlName="estado">
              <option value="Novo">‚ú® Novo</option>
              <option value="Bom">‚úÖ Bom</option>
              <option value="Regular">‚ö†Ô∏è Regular</option>
              <option value="Danificado">üõ†Ô∏è Danificado</option>
              <option value="Baixado">üóëÔ∏è Baixado (Descarte)</option>
            </select>
          </div>

          <div class="form-group">
            <label>Localiza√ß√£o Atual</label>
            <input formControlName="localizacao" type="text" placeholder="Ex: Sala do CA">
          </div>

          <div class="form-actions">
            <button type="submit" [disabled]="form.invalid || loading" class="btn btn-primary">
              {{ loading ? 'Salvando...' : (modoEdicao ? 'Atualizar' : 'Cadastrar') }}
            </button>
            
            <button *ngIf="modoEdicao" type="button" (click)="cancelarEdicao()" class="btn btn-secondary">
              Cancelar
            </button>
          </div>
        </form>
      </div>
    </section>

    <section class="list-section">
      <div class="card">
        
        <div *ngIf="loading && itens.length === 0" class="loading-state">
          <div class="spinner"></div>
          <p>Carregando patrim√¥nio...</p>
        </div>

        <table class="data-table" *ngIf="!loading || itens.length > 0">
          <thead>
            <tr>
              <th>Item / Local</th>
              <th>Estado</th>
              <th class="text-right">Valor</th>
              <th class="text-center">A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of itens">
              <td>
                <div class="item-name">{{ item.nome }}</div>
                <div class="item-meta">
                  <span *ngIf="item.tombo">üè∑Ô∏è {{ item.tombo }}</span>
                  <span *ngIf="item.localizacao">üìç {{ item.localizacao }}</span>
                </div>
              </td>
              <td>
                <span class="status-badge" 
                  [ngClass]="(item.estado || item.status || '').toLowerCase()">
                  
                  {{ item.estado || item.status }}
                
                </span>
              </td>
              <td class="text-right font-mono">
                {{ (item.valor || 0) | currency:'BRL':'symbol':'1.2-2' }}
              </td>
              <td class="text-center">
                <button (click)="editar(item)" class="btn-icon edit" title="Editar">‚úèÔ∏è</button>
                <button (click)="deletar(item.id!)" class="btn-icon delete" title="Excluir">üóëÔ∏è</button>
              </td>
            </tr>

            <tr *ngIf="itens.length === 0 && !loading">
              <td colspan="4" class="empty-state">
                Nenhum item cadastrado ainda.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>
</div>